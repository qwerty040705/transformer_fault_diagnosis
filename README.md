# üöÄ Transformer Fault Diagnosis

This repository contains a full pipeline for simulating motor faults, generating labeled time-series data, and training a Transformer-based fault diagnosis model.  

‚öôÔ∏è **Data Generation**  
Data can be generated by running `data_generate/data_generate.py`. When executed, enter the desired number of links at the `How many links?:` prompt. The number of samples (`NUM_SAMPLES`) can be changed around line 286 in the script, which can be quickly located by searching for `# ****************  Number of dataset  ********************` in the file.  

üíæ **Output Location**  
Once the script finishes, the generated dataset will be saved in `data_storage/link_{number_of_links}/fault_dataset.npz`.  

ü©∫ **Data Integrity Check**  
To verify the integrity of the dataset, `check_dataset_NaN&inf.py` can be used to detect any NaN or Inf values.  

üîç **Detailed Inspection**  
For a closer inspection, `check_dataset_SE3.py` allows you to view the label array (fault status), the desired and actual SE(3) transformation matrices, as well as their decomposed position vectors and rotation matrices for specific samples and timesteps, and it also lists fault occurrences in `(time, motor)` format.  


### üíª Example Usage

**1) Data Generation**
```bash
$ python3 data_generate/data_generate.py
How many links?: 1
Generating samples [####################################################################################################] 100.0% (100/100)
Dataset saved successfully to data_storage/link_1/fault_dataset.npz
```

**2) Data Integrity Check**
```bash
$ python3 check_dataset_NaN&inf.py
How many links do you want to check?: 1
‚úÖ desired: No NaN/inf found.
‚úÖ actual: No NaN/inf found.
‚úÖ label: No NaN/inf found.
```

**2) Detailed Inspection**
```bash
$ python3 check_dataset_SE3.py
How many links do you want to check?: 1
desired.shape = (100, 200, 4, 4)
actual.shape  = (100, 200, 4, 4)
label.shape   = (100, 200, 8) (motor_count=8)

==================================================
[Sample 0, Time 0]
Motor labels: [1 1 1 1 1 1 1 1]

Desired SE(3):
 [[ 0.88056938  0.43114424  0.19675417  0.88056938]
 [-0.18371408 -0.07215812  0.98032767 -0.18371408]
 [ 0.43686004 -0.89939304  0.01566704  0.43686004]
 [ 0.          0.          0.          1.        ]]

Actual SE(3):
 [[ 0.88056938  0.43114424  0.19675417  0.88056938]
 [-0.18371408 -0.07215812  0.98032767 -0.18371408]
 [ 0.43686004 -0.89939304  0.01566704  0.43686004]
 [ 0.          0.          0.          1.        ]]

==================================================
[Sample 0, Time 100]
Motor labels: [1 1 1 1 1 1 1 0]

Desired SE(3):
 [[ 0.88056938  0.43114424  0.19675417  0.87490948]
 [-0.18371408 -0.07215812  0.98032767 -0.18908315]
 [ 0.43686004 -0.89939304  0.01566704  0.44584859]
 [ 0.          0.          0.          1.        ]]

Actual SE(3):
 [[ 0.77758677  0.59474917  0.20403978  0.77758677]
 [-0.09997082 -0.20343514  0.97397124 -0.09997082]
 [ 0.62077745 -0.77774518 -0.09873091  0.62077745]
 [ 0.          0.          0.          1.        ]]

==================================================
[Sample 0, Time 199]
Motor labels: [1 1 1 1 1 1 1 0]

Desired SE(3):
 [[ 0.88056938  0.43114424  0.19675417  0.86854637]
 [-0.18371408 -0.07215812  0.98032767 -0.19693976]
 [ 0.43686004 -0.89939304  0.01566704  0.45479879]
 [ 0.          0.          0.          1.        ]]

Actual SE(3):
 [[ 0.34617462 -0.14209196 -0.9273473   0.34617462]
 [ 0.09157589 -0.97862585  0.18413394  0.09157589]
 [-0.93368998 -0.14866515 -0.32576324 -0.93368998]
 [ 0.          0.          0.          1.        ]]
```
